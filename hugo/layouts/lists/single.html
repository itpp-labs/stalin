{{ partial "header" . }}
{{ partial "nav" . }}
{{ $data := index .Site.Data.lists .File.BaseFileName }}
<div class="container">
    <h2 class="subtitle is-size-4-mobile is-size-3-desktop">{{ $data.archive.ref }}, лист {{ $data.archive.page1 }}</h2>
        <div class="content">


<div class="pages">
{{ range $data.pages }}
    <div id="image-{{ .pageintom }}"><img src="/disk/pictures/{{ .image }}"/></div>
{{ end }}
</div>
<div class="pages-preview is-hidden-mobile">
    {{ range $data.pages }}
    <span><img width="30" src="/disk/pictures/{{ .image }}"/></span>
    {{ end }}
</div>
<script type="text/javascript">
 var target = window.location.hash;
 var target_index = 0;
 if (target.indexOf("#image-") != -1 ){
     target_index = $('.pages > div').index($(target));
 }

 window.slider = tns({
     startIndex: target_index,
     container: ".pages",
     gutter: 5,
     navContainer: ".pages-preview",
     //     navPosition: "bottom",
     mouseDrag: true,
     navAsThumbnails: true,
     arrowKeys: true,
     controls: false,
     onInit: function(){
     }
     //     controlsPosition: "bottom",
     //     controlsText: ["Предыдущая страница", "Следующая страница"]
 });

</script>

{{ range $data.sublists }}
<h3> {{ .title }} </h3>

  {{ range .pages }}
    {{ $pageintom := .pageintom }}

    <div id="page-{{ $pageintom }}" class="mt-5 is-clearfix">

          <h4 class="has-text-right"><span>{{ $data.archive.ref }}, лист </span><span class="is-size-2">{{ $pageintom }}<span></h4>

          <div class="page-image page-image-preview is-pulled-right ml-5">
              <img src="/disk/pictures/{{ .page_image }}"/>
          </div>

          <div class="page-text">

              {{ range .persons }}
                  {{ if .subtitle1 }}{{ .subtitle1 | safeHTML }}{{ end }}
                  {{/* TODO: it's a mess */}}
              {{ if .primzv }} <div class="columns primzv is-gapless"><div class="column primzv-num is-1">{{ .num }}.</div><div class="column primzv-name is-3">{{ end }}
              <p id="page-{{ $pageintom }}-num-{{ .num }}{{ if .rowinpage }}-{{ .rowinpage }}{{ end }}" class="person{{ if .striked }} striked{{end}}{{ if .underlined }} underlined{{end}}"><span class="num-name">{{ if not .primzv }}{{ .num }}. {{ end }}{{ .name | safeHTML }}</span>&nbsp;
                  {{ if .pometa_text }} <span class="pometa">{{.pometa_text}}</span>{{end}}
                  {{ if .doublesexists }} <a href="/persons/p{{ .id }}#spiski" title="Встречается в нескольких списках"><i class="fas fa-list"></i></span></a>{{end}}
                  {{ if .spravka }} <a href="/persons/p{{ .id }}#spravka" title="Имеется дополнительная информация"><i class="fas fa-book"></i></span></a>{{end}}
                  {{ if .gb_spravka }} <a href="/persons/p{{ .id }}#gb-{{ $data.id }}" title="Имеется версия следствия"><i class="fas fa-id-card"></i></span></a>{{end}}
                  {{ if .primcoc }} <span class="pometa">{{ .primcoc }}</span>{{ end }}
              </p>
                  {{ if .primzv }}
                  </div>
                  <div class="column primzv-zv is-4">
                      {{ .primzv }}
                  </div>
                  </div>

                  {{ end }}

              {{ end }}

          </div>
          <div class="is-hidden page-image">
              <img src="/disk/pictures/{{ .page_image }}"/>
          </div>
   </div>
  {{ end }}

{{ end }}

        </div>
</div>

        {{ partial "jsshare" . }}
        {{ partial "disqus" . }}
        {{ partial "footer" . }}
